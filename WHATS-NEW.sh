#!/bin/bash

# 🎉 НОВЫЕ ВОЗМОЖНОСТИ - ИНТЕРАКТИВНАЯ РАБОТА С GITHUB

cat << "EOF"

╔════════════════════════════════════════════════════════════════════════╗
║                                                                        ║
║   🎉 НОВЫЕ ВОЗМОЖНОСТИ: ИНТЕРАКТИВНАЯ РАБОТА С GITHUB РЕПОЗИТОРИЯМИ ║
║                                                                        ║
╚════════════════════════════════════════════════════════════════════════╝

════════════════════════════════════════════════════════════════════════════

✨ ЧТО ИЗМЕНИЛОСЬ:

════════════════════════════════════════════════════════════════════════════

Раньше:
  • Нужно было использовать готовую конфигурацию из ansible-repo/
  • Нельзя было работать с другими репозиториями
  • Нужно было вручную искать плейбуки и роли

Теперь:
  • ✅ Работайте с ЛЮБЫМ GitHub репозиторием
  • ✅ Вводите ссылку прямо в программе
  • ✅ Автоматически находите плейбуки
  • ✅ Генерируйте готовые команды
  • ✅ Тестируйте локально

════════════════════════════════════════════════════════════════════════════

🎯 НОВЫЕ СКРИПТЫ:

════════════════════════════════════════════════════════════════════════════

1. ansible-pull-interactive.sh (большой интерактивный скрипт)
   └─ Полная программа для работы с репозиториями
   └─ 10 этапов обработки
   └─ Готовые команды ansible-pull

2. run-interactive.sh (запускатель)
   └─ Быстрый запуск с красивым оформлением
   └─ Информация о режимах работы

3. INTERACTIVE-README.md
   └─ Полное руководство на русском
   └─ Примеры использования
   └─ FAQ

════════════════════════════════════════════════════════════════════════════

🚀 КАК ИСПОЛЬЗОВАТЬ:

════════════════════════════════════════════════════════════════════════════

СПОСОБ 1️⃣ - Интерактивный ввод (рекомендуется для новичков)
─────────────────────────────────────────────────────────────
$ bash run-interactive.sh

Программа запросит URL репозитория, вы его вводите, и она всё сделает.

─────────────────────────────────────────────────────────────

СПОСОБ 2️⃣ - Прямая передача URL
────────────────────────────────────────────────────────────
$ bash ansible-pull-interactive.sh https://github.com/user/repo.git

Программа сразу клонирует репозиторий и покажет меню опций.

────────────────────────────────────────────────────────────

════════════════════════════════════════════════════════════════════════════

📌 ПРИМЕРЫ КОМАНД:

════════════════════════════════════════════════════════════════════════════

Пример 1️⃣ - Интерактивный режим
────────────────────────────────
$ bash run-interactive.sh
# Введите: https://github.com/ansible/ansible-examples.git
# Выбирайте действия из меню

────────────────────────────────

Пример 2️⃣ - С публичным репозиторием
──────────────────────────────────────
$ bash ansible-pull-interactive.sh https://github.com/ansible/ansible-examples.git

────────────────────────────────────

Пример 3️⃣ - С вашим репозиторием
──────────────────────────────────
$ bash ansible-pull-interactive.sh https://github.com/ваше-имя/мой-playbook.git

──────────────────────────────────

Пример 4️⃣ - С приватным репозиторием (SSH)
────────────────────────────────────────────
$ bash ansible-pull-interactive.sh git@github.com:user/private-repo.git

────────────────────────────────────────────

════════════════════════════════════════════════════════════════════════════

🎯 ЧТО ДЕЛАЕТ ПРОГРАММА (10 ЭТАПОВ):

════════════════════════════════════════════════════════════════════════════

1️⃣  ВВД РЕПОЗИТОРИЯ
    • Запросит URL или примет как аргумент
    • Проверит формат ссылки

2️⃣  ПРОВЕРКА РЕПОЗИТОРИЯ
    • Клонирует репозиторий локально
    • Проверит доступность GitHub
    • Сохранит в /tmp/ansible-pull-work/

3️⃣  ПРОСМОТР СТРУКТУРЫ
    • Покажет всю структуру файлов
    • Выведет дерево директорий
    • Найдет важные файлы

4️⃣  ПРОВЕРКА ANSIBLE ФАЙЛОВ
    • Найдет все .yml и .yaml файлы
    • Поищет директорию roles
    • Проверит наличие inventory

5️⃣  ПРОСМОТР СОДЕРЖИМОГО
    • Покажет основной плейбук
    • Выведет файл инвентаря
    • Отобразит конфигурацию

6️⃣  ПРОВЕРКА СИНТАКСИСА
    • Валидирует YAML синтаксис
    • Проверит плейбуки на ошибки
    • Требует ansible (pip install ansible)

7️⃣  ГЕНЕРАЦИЯ КОМАНД
    • Создаст 3 варианта команд ansible-pull
    • Базовая, с инвентарем, для cron
    • Готовые к копированию

8️⃣  ЛОКАЛЬНОЕ ТЕСТИРОВАНИЕ
    • Запустит плейбук в режиме --check
    • Покажет что изменится
    • Не применит изменения

9️⃣  ИНФОРМАЦИЯ О GIT
    • История коммитов
    • Текущая ветка
    • Статус репозитория

🔟 ИТОГОВАЯ ИНФОРМАЦИЯ
    • Сводка о всем репозитории
    • Рекомендации что делать дальше

════════════════════════════════════════════════════════════════════════════

💡 ПРИМЕНЕНИЕ КОМАНД НА ЦЕЛЕВОЙ МАШИНЕ:

════════════════════════════════════════════════════════════════════════════

Шаг 1️⃣  - Скопируйте готовую команду из программы
────────────────────────────────────────────────────

Программа генерирует:
$ sudo ansible-pull -U https://github.com/user/repo.git \
    -d /var/lib/ansible/pull \
    playbook.yml -v

────────────────────────────────────────────────────

Шаг 2️⃣  - Выполните на целевой машине
────────────────────────────────────────────────────

$ ssh user@target-vm
$ sudo ansible-pull -U https://github.com/user/repo.git \
    -d /var/lib/ansible/pull \
    playbook.yml -v

────────────────────────────────────────────────────

Шаг 3️⃣  - Добавьте в cron (для автоматизации)
────────────────────────────────────────────────────

$ sudo crontab -e

# Добавьте строку из программы:
*/30 * * * * ansible-pull -U https://github.com/user/repo.git \
  -d /var/lib/ansible/pull playbook.yml >> /var/log/ansible-pull.log 2>&1

────────────────────────────────────────────────────

════════════════════════════════════════════════════════════════════════════

🔐 ТИПЫ РЕПОЗИТОРИЕВ:

════════════════════════════════════════════════════════════════════════════

ПУБЛИЧНЫЕ (никаких прав не нужны):
  https://github.com/ansible/ansible-examples.git

ПРИВАТНЫЕ (HTTPS с токеном):
  https://github.com:user:token@github.com/user/private.git

ПРИВАТНЫЕ (SSH - рекомендуется):
  git@github.com:user/private-repo.git
  (требуется SSH ключ на GitHub)

════════════════════════════════════════════════════════════════════════════

📊 СРАВНЕНИЕ СПОСОБОВ РАБОТЫ:

════════════════════════════════════════════════════════════════════════════

РАНЬШЕ (демонстрационная конфигурация):
  ✓ Было: REPORT.md, COMMANDS.md, demo-pretty.sh
  ✓ Использовали: готовую конфигурацию из ansible-repo/
  ✓ Для сдачи: достаточно этих файлов

ТЕПЕРЬ (интерактивная система):
  ✓ Добавили: ansible-pull-interactive.sh
  ✓ Используете: ЛЮБЫй GitHub репозиторий
  ✓ Для работы: просто передаёте ссылку
  ✓ Сделано: полная аналитика и команды

════════════════════════════════════════════════════════════════════════════

✅ ПОЛНЫЙ ФУНКЦИОНАЛ:

════════════════════════════════════════════════════════════════════════════

БЫЛО:
  ✓ Полная документация (REPORT.md, README.md)
  ✓ Красивая демонстрация (demo-pretty.sh)
  ✓ Готовые команды (COMMANDS.md)
  ✓ Конфигурация (ansible-repo/)

ДОБАВИЛОСЬ:
  ✓ Интерактивная работа с GitHub (ansible-pull-interactive.sh)
  ✓ Автоматическое нахождение плейбуков
  ✓ Генерация команд для любого репозитория
  ✓ Локальное тестирование
  ✓ Работа с приватными репозиториями

════════════════════════════════════════════════════════════════════════════

🎓 УЧЕБНЫЕ ПРИМЕРЫ:

════════════════════════════════════════════════════════════════════════════

Если хотите поэкспериментировать, используйте публичные репозитории:

# Ansible Examples (примеры плейбуков):
https://github.com/ansible/ansible-examples.git

# Ansible Playbooks (коллекция плейбуков):
https://github.com/ansible/playbooks

# Geerlingguy Roles (готовые роли):
https://github.com/geerlingguy/ansible-role-docker

════════════════════════════════════════════════════════════════════════════

🎯 РЕКОМЕНДУЕМЫЙ ПРОЦЕСС:

════════════════════════════════════════════════════════════════════════════

Для СДАЧИ РАБОТЫ:
  1. Используйте готовую конфигурацию (ansible-repo/)
  2. Показывайте красивую демонстрацию (demo-pretty.sh)
  3. Используйте отчет (REPORT.md)

Для РЕАЛЬНОЙ РАБОТЫ:
  1. Используйте интерактивный скрипт (ansible-pull-interactive.sh)
  2. Передавайте свой репозиторий
  3. Получайте готовые команды
  4. Применяйте на ВМ

════════════════════════════════════════════════════════════════════════════

🎉 ИТОГО:

════════════════════════════════════════════════════════════════════════════

БЫЛО 17 файлов       →    СТАЛО 19 файлов

ДОБАВИЛИ:
  • ansible-pull-interactive.sh  (работа с любым репозиторием)
  • run-interactive.sh            (удобный запуск)
  • INTERACTIVE-README.md         (полное руководство)

════════════════════════════════════════════════════════════════════════════

🚀 НАЧНИТЕ ПРЯМО СЕЙЧАС:

════════════════════════════════════════════════════════════════════════════

$ bash run-interactive.sh

И вводите ссылку на нужный вам GitHub репозиторий!

════════════════════════════════════════════════════════════════════════════

EOF
